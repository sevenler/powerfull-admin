{"version":3,"sources":["/examples/components/MdRenderer.jsx"],"names":[],"mappings":"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","file":"MdRenderer.js","sourcesContent":["/* eslint-disable no-unused-vars */\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport {render} from '../../src/index';\nimport axios from 'axios';\nimport TitleBar from '../../src/components/TitleBar';\nimport LazyComponent from '../../src/components/LazyComponent';\nimport Overlay from '../../src/components/Overlay';\nimport PopOver from '../../src/components/PopOver';\nimport NestedLinks from '../../src/components/AsideNav';\nimport {Portal} from 'react-overlays';\n\nclass CodePreview extends React.Component {\n  state = {\n    PlayGround: null\n  };\n  componentDidMount() {\n    require(['./Play'], component =>\n      this.setState({\n        PlayGround: component.default\n      }));\n  }\n\n  render() {\n    const {\n      container,\n      height,\n      setAsideFolded,\n      setHeaderVisible,\n      ...rest\n    } = this.props;\n\n    const PlayGround = this.state.PlayGround;\n    // 不要放在 .markdown-body 下面，因为样式会干扰，复写又麻烦，所以通过 Overlay 渲染到同级\n\n    return (\n      <div>\n        <span style={{display: 'block', height: height}} ref=\"span\" />\n        {PlayGround ? (\n          <Overlay\n            container={container}\n            target={() => this.refs.span}\n            placement=\"bottom\"\n            show\n          >\n            <PopOver\n              offset={{x: 0, y: -height}}\n              style={{height}}\n              className=\"doc-shcema-preview-popover\"\n            >\n              <div className=\"doc-schema-preview\">\n                <PlayGround {...rest} vertical />\n              </div>\n            </PopOver>\n          </Overlay>\n        ) : null}\n      </div>\n    );\n  }\n}\n\nfunction isActive(link, location) {\n  return !!(link.fullPath && link.fullPath === location.hash);\n}\n\nexport default function(doc) {\n  return class extends React.Component {\n    static displayName = 'MarkdownRenderer';\n    ref = null;\n    doms = [];\n    constructor(props) {\n      super(props);\n      this.divRef = this.divRef.bind(this);\n      this.handleClick = this.handleClick.bind(this);\n    }\n\n    componentDidMount() {\n      this.renderSchema();\n\n      if (location.hash && location.hash.length > 1) {\n        // 禁用自动跳转\n        if (window.history && 'scrollRestoration' in window.history) {\n          window.history.scrollRestoration = 'manual';\n        }\n\n        const dom = document.querySelector(\n          `[name=\"${location.hash.substring(1)}\"]`\n        );\n        dom && dom.scrollIntoView();\n      }\n    }\n\n    componentDidUpdate() {\n      this.renderSchema();\n    }\n\n    componentWillUnmount() {\n      this.doms.forEach(dom => ReactDOM.unmountComponentAtNode(dom));\n    }\n\n    handleClick(e) {\n      const href = e.target.getAttribute('href');\n      if (href && href[0] !== '#' && !/^http/.test(href)) {\n        e.preventDefault();\n        this.props.push(href);\n      }\n    }\n\n    divRef(ref) {\n      this.ref = ref;\n\n      if (ref) {\n        ref.innerHTML = doc.html;\n      }\n    }\n\n    renderSchema() {\n      const scripts = document.querySelectorAll('script[type=\"text/schema\"]');\n      if (!scripts && !scripts.length) {\n        return;\n      }\n\n      for (let i = 0, len = scripts.length; i < len; i++) {\n        let script = scripts[i];\n        let props = {};\n        [].slice.apply(script.attributes).forEach(item => {\n          props[item.name] = item.value;\n        });\n\n        let dom = document.createElement('div');\n        let height = props.height ? parseInt(props.height, 10) : 200;\n        dom.setAttribute('class', 'doc-play-ground');\n        dom.setAttribute('style', `height: ${height}px;`);\n        script.parentNode.replaceChild(dom, script);\n\n        this.doms.push(dom);\n        ReactDOM.unstable_renderSubtreeIntoContainer(\n          this,\n          <LazyComponent\n            {...this.props}\n            container={() => ReactDOM.findDOMNode(this)}\n            height={height}\n            component={CodePreview}\n            code={script.innerText}\n            scope={props.scope}\n            unMountOnHidden\n            placeholder=\"加载中，请稍后。。。\"\n          />,\n          dom\n        );\n      }\n    }\n\n    render() {\n      const {location} = this.props;\n\n      return (\n        <div className=\"pos-rlt text-left\">\n          {doc.title ? <TitleBar title={doc.title} /> : null}\n          <div className=\"markdown-body\" ref={this.divRef}>\n            Doc\n          </div>\n          {doc.toc && doc.toc.children && doc.toc.children.length > 1 ? (\n            <Portal container={() => document.querySelector('#asideInner')}>\n              <NestedLinks\n                navigations={[doc.toc]}\n                renderLink={({\n                  link,\n                  active,\n                  toggleExpand,\n                  depth,\n                  classnames: cx\n                }) => {\n                  let children = [];\n\n                  if (link.children) {\n                    children.push(\n                      <span\n                        key=\"expand-toggle\"\n                        className={cx(`AsideNav-itemArrow`)}\n                      />\n                    );\n                  }\n\n                  link.badge &&\n                    children.push(\n                      <b\n                        key=\"badge\"\n                        className={cx(\n                          'AsideNav-itemBadge',\n                          link.badgeClassName || 'bg-info'\n                        )}\n                      >\n                        {link.badge}\n                      </b>\n                    );\n\n                  depth === 1 &&\n                    children.push(\n                      <i\n                        key=\"icon\"\n                        className={cx('AsideNav-itemIcon fa fa-flag')}\n                      />\n                    );\n\n                  children.push(\n                    <span key=\"label\" className={cx('AsideNav-itemLabel')}>\n                      {link.label}\n                    </span>\n                  );\n\n                  return link.fragment ? (\n                    <a href={`#${link.fragment}`}>{children}</a>\n                  ) : (\n                    <a\n                      onClick={link.children ? () => toggleExpand(link) : null}\n                    >\n                      {children}\n                    </a>\n                  );\n                }}\n                isActive={link => isActive(link, location)}\n              />\n            </Portal>\n          ) : null}\n        </div>\n      );\n    }\n  };\n}\n"]}