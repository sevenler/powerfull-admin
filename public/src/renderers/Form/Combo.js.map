{"version":3,"sources":["/src/renderers/Form/Combo.tsx"],"names":[],"mappings":"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","file":"Combo.js","sourcesContent":["import React from 'react';\nimport {findDOMNode} from 'react-dom';\nimport {FormItem, FormControlProps} from './Item';\nimport {Schema, Action, Api} from '../../types';\nimport {ComboStore, IComboStore} from '../../store/combo';\nimport {default as CTabs, Tab} from '../../components/Tabs';\n\nimport {\n  guid,\n  anyChanged,\n  isObject,\n  createObject,\n  extendObject,\n  autobind,\n  isObjectShallowModified\n} from '../../utils/helper';\nimport Sortable from 'sortablejs';\nimport {evalExpression, filter} from '../../utils/tpl';\nimport find from 'lodash/find';\nimport Select from '../../components/Select';\nimport {dataMapping, resolveVariable} from '../../utils/tpl-builtin';\nimport {isEffectiveApi} from '../../utils/api';\nimport {Alert2} from '../../components';\nimport memoize from 'lodash/memoize';\nexport interface Condition {\n  test: string;\n  controls: Array<Schema>;\n  label: string;\n  scaffold?: any;\n  mode?: string;\n}\n\nfunction pickVars(vars:any, fields: Array<string>) {\n  return fields.reduce((data:any, key: string) => {\n    data[key] = resolveVariable(key, vars);\n    return data;\n  }, {})\n}\n\nexport interface ComboProps extends FormControlProps {\n  placeholder?: string;\n  flat?: boolean; // 是否把值打平，即原来是对象现在只有对象中的值。\n  draggable?: boolean; // 是否可拖拽\n  controls?: Array<Schema>;\n  conditions?: Array<Condition>;\n  multiple?: boolean;\n  multiLine?: boolean;\n  minLength?: number;\n  maxLength?: number;\n  scaffold?: any;\n  addButtonClassName?: string;\n  formClassName?: string;\n  addButtonText?: string;\n  addable?: boolean;\n  typeSwitchable?: boolean;\n  removable?: boolean;\n  deleteApi?: Api;\n  deleteConfirmText?: string;\n  canAccessSuperData?: boolean;\n  subFormMode?: 'normal' | 'inline' | 'horizontal';\n  noBorder?: boolean;\n  joinValues?: boolean;\n  delimiter?: string;\n  dragIcon: string;\n  deleteIcon: string;\n  store: IComboStore;\n  tabsMode: boolean;\n  tabsStyle: '' | 'line' | 'card' | 'radio';\n  tabsLabelTpl?: string;\n  lazyLoad?: boolean;\n  changeImmediately?: boolean;\n  strictMode?: boolean;\n  messages?: {\n    validateFailed?: string;\n    minLengthValidateFailed?: string;\n    maxLengthValidateFailed?: string;\n  };\n}\n\nexport default class ComboControl extends React.Component<ComboProps> {\n  static defaultProps = {\n    minLength: 0,\n    maxLength: 0,\n    multiple: false,\n    multiLine: false,\n    addButtonClassName: '',\n    formClassName: '',\n    subFormMode: 'normal',\n    draggableTip: '可拖拽排序',\n    addButtonText: '新增',\n    canAccessSuperData: false,\n    addIcon: 'fa fa-plus',\n    dragIcon: 'glyphicon glyphicon-sort',\n    deleteIcon: 'glyphicon glyphicon-remove',\n    tabsMode: false,\n    tabsStyle: ''\n  };\n  static propsList: Array<string> = [\n    'minLength',\n    'maxLength',\n    'multiple',\n    'multiLine',\n    'addButtonClassName',\n    'subFormMode',\n    'draggableTip',\n    'addButtonText',\n    'draggable',\n    'scaffold',\n    'canAccessSuperData',\n    'addIcon',\n    'dragIcon',\n    'deleteIcon',\n    'noBorder',\n    'conditions',\n    'tabsMode',\n    'tabsStyle',\n    'lazyLoad',\n    'changeImmediately',\n    'strictMode',\n    'controls',\n    'conditions',\n    'messages'\n  ];\n\n  subForms: Array<any> = [];\n  subFormDefaultValues: Array<{\n    index: number;\n    values: any;\n    setted: boolean;\n  }> = [];\n\n  keys: Array<string> = [];\n  dragTip?: HTMLElement;\n  sortable?: Sortable;\n  defaultValue?: any;\n  toDispose: Array<Function> = [];\n  id: string = guid();\n  constructor(props: ComboProps) {\n    super(props);\n\n    this.handleChange = this.handleChange.bind(this);\n    this.handleSingleFormChange = this.handleSingleFormChange.bind(this);\n    this.handleSingleFormInit = this.handleSingleFormInit.bind(this);\n    this.handleFormInit = this.handleFormInit.bind(this);\n    this.handleAction = this.handleAction.bind(this);\n    this.addItem = this.addItem.bind(this);\n    this.removeItem = this.removeItem.bind(this);\n    this.dragTipRef = this.dragTipRef.bind(this);\n    this.flush = this.flush.bind(this);\n    this.handleComboTypeChange = this.handleComboTypeChange.bind(this);\n    this.defaultValue = {\n      ...props.scaffold\n    };\n  }\n\n  componentWillMount() {\n    const {store, value, minLength, maxLength, formItem, addHook} = this.props;\n\n    store.config({\n      minLength,\n      maxLength,\n      length: this.getValueAsArray().length\n    });\n\n    formItem && formItem.setSubStore(store);\n    addHook && this.toDispose.push(addHook(this.flush, 'flush'));\n  }\n\n  componentWillReceiveProps(nextProps: ComboProps) {\n    const props = this.props;\n\n    if (anyChanged(['minLength', 'maxLength', 'value'], props, nextProps)) {\n      const {store, minLength, maxLength} = nextProps;\n      const values = this.getValueAsArray(nextProps);\n\n      store.config({\n        minLength,\n        maxLength,\n        length: values.length\n      });\n\n      if (store.activeKey >= values.length) {\n        store.setActiveKey(Math.max(0, values.length - 1));\n      }\n\n      // combo 进来了新的值，且这次 form 初始化时带来的新值变化，但是之前的值已经 onInit 过了\n      // 所以，之前 onInit 设置进去的初始值是过时了的。这个时候修复一下。\n      if (nextProps.value !== props.value && !props.formInited && this.subFormDefaultValues.length) {\n        this.subFormDefaultValues = this.subFormDefaultValues.map((item, index) => {\n          return {\n            ...item,\n            values: values[index]\n          }\n        })  \n      }\n    }\n  }\n\n  componentWillUnmount() {\n    const {formItem} = this.props;\n\n    formItem && formItem.setSubStore(null);\n\n    this.toDispose.forEach(fn => fn());\n    this.toDispose = [];\n    this.memoizedFormatValue.cache.clear?.();\n    this.makeFormRef.cache.clear?.();\n  }\n\n  getValueAsArray(props = this.props) {\n    const {flat, joinValues, delimiter} = props;\n    let value = props.value;\n\n    if (joinValues && flat && typeof value === 'string') {\n      value = value.split(delimiter || ',');\n    } else if (!Array.isArray(value)) {\n      value = [];\n    } else {\n      value = value.concat();\n    }\n    return value;\n  }\n\n  addItemWith(condition: Condition) {\n    const {\n      flat,\n      joinValues,\n      delimiter,\n      scaffold,\n      disabled,\n      submitOnChange\n    } = this.props;\n\n    if (disabled) {\n      return;\n    }\n\n    let value = this.getValueAsArray();\n\n    value.push(\n      flat\n        ? condition.scaffold || scaffold || ''\n        : {\n            ...(condition.scaffold || scaffold)\n          }\n    );\n    this.keys.push(guid());\n\n    if (flat && joinValues) {\n      value = value.join(delimiter || ',');\n    }\n\n    this.props.onChange(value, submitOnChange, true);\n  }\n\n  addItem() {\n    const {\n      flat,\n      joinValues,\n      delimiter,\n      scaffold,\n      disabled,\n      submitOnChange\n    } = this.props;\n\n    if (disabled) {\n      return;\n    }\n\n    let value = this.getValueAsArray();\n\n    value.push(\n      flat\n        ? scaffold || ''\n        : {\n            ...scaffold\n          }\n    );\n    this.keys.push(guid());\n\n    if (flat && joinValues) {\n      value = value.join(delimiter || ',');\n    }\n\n    this.props.onChange(value, submitOnChange, true);\n  }\n\n  async removeItem(key: number) {\n    const {\n      flat,\n      joinValues,\n      delimiter,\n      disabled,\n      deleteApi,\n      deleteConfirmText,\n      data,\n      env\n    } = this.props;\n\n    if (disabled) {\n      return;\n    }\n\n    let value = this.getValueAsArray();\n    const ctx = createObject(data, value[key]);\n\n    if (isEffectiveApi(deleteApi, ctx)) {\n      const confirmed = await env.confirm(\n        deleteConfirmText ? filter(deleteConfirmText, ctx) : '确认要删除？'\n      );\n      if (!confirmed) {\n        // 如果不确认，则跳过！\n        return;\n      }\n\n      const result = await env.fetcher(deleteApi as Api, ctx);\n\n      if (!result.ok) {\n        env.notify('error', '删除失败');\n        return;\n      }\n    }\n\n    value.splice(key, 1);\n    this.keys.splice(key, 1);\n\n    if (flat && joinValues) {\n      value = value.join(delimiter || ',');\n    }\n\n    this.props.onChange(value);\n  }\n\n  handleChange(values: any, diff: any, {index}: any) {\n    const {\n      flat,\n      store,\n      joinValues,\n      delimiter,\n      disabled,\n      submitOnChange\n    } = this.props;\n\n    if (disabled) {\n      return;\n    }\n\n    let value = this.getValueAsArray();\n    value[index] = flat ? values.flat : {...values};\n\n    if (flat && joinValues) {\n      value = value.join(delimiter || ',');\n    }\n\n    this.props.onChange(value, submitOnChange, true);\n\n    store.forms.forEach(item =>\n      item.items.forEach(item => item.unique && item.syncOptions())\n    );\n  }\n\n  handleSingleFormChange(values: object) {\n    this.props.onChange(\n      {\n        ...values\n      },\n      this.props.submitOnChange,\n      true\n    );\n  }\n\n  handleFormInit(values: any, {index}: any) {\n    const {\n      syncDefaultValue,\n      flat,\n      joinValues,\n      delimiter,\n      formInited,\n      onChange,\n      submitOnChange,\n      setPrinstineValue\n    } = this.props;\n\n    this.subFormDefaultValues.push({\n      index,\n      values,\n      setted: false\n    });\n\n    if (syncDefaultValue === false  || this.subFormDefaultValues.length !== this.subForms.length) {\n      return;\n    }\n\n    let value = this.getValueAsArray();\n    let isModified = false;\n    this.subFormDefaultValues = this.subFormDefaultValues.map(\n      ({index, values, setted}) => {\n        const newValue = flat ? values.flat : {...values};\n\n        if (!setted && isObjectShallowModified(value[index], newValue)) {\n          value[index] = flat ? values.flat : {...values};\n          isModified = true;\n        }\n\n        return {\n          index,\n          values,\n          setted: true\n        };\n      }\n    );\n\n    if (!isModified) {\n      return;\n    }\n\n    if (flat && joinValues) {\n      value = value.join(delimiter || ',');\n    }\n\n    formInited\n      ? onChange(value, submitOnChange, true)\n      : setPrinstineValue(value);\n  }\n\n  handleSingleFormInit(values: any) {\n    const {syncDefaultValue, setPrinstineValue, value} = this.props;\n\n\n    if (syncDefaultValue !== false && isObjectShallowModified(value, values) && setPrinstineValue) {\n      setPrinstineValue({\n        ...values\n      })\n    }\n  }\n\n  handleAction(action: Action): any {\n    const {onAction} = this.props;\n\n    if (action.actionType === 'delete') {\n      action.index !== void 0 && this.removeItem(action.index);\n      return;\n    }\n\n    onAction && onAction.apply(null, arguments);\n  }\n\n  validate(): any {\n    const {value, minLength, maxLength, messages} = this.props;\n\n    if (minLength && (!Array.isArray(value) || value.length < minLength)) {\n      return (\n        (messages && messages.minLengthValidateFailed) ||\n        `组合表单成员数量不够，低于设定的最小${minLength}个，请添加更多的成员。`\n      );\n    } else if (maxLength && Array.isArray(value) && value.length > maxLength) {\n      return (\n        (messages && messages.maxLengthValidateFailed) ||\n        `组合表单成员数量超出，超出设定的最大${maxLength}个，请删除多余的成员。`\n      );\n    } else if (this.subForms.length) {\n      return Promise.all(this.subForms.map(item => item.validate())).then(\n        values => {\n          if (~values.indexOf(false)) {\n            return (\n              (messages && messages.validateFailed) ||\n              '子表单验证失败，请仔细检查'\n            );\n          }\n\n          return;\n        }\n      );\n    }\n  }\n\n  flush() {\n    this.subForms.forEach(form => form.flush());\n  }\n\n  dragTipRef(ref: any) {\n    if (!this.dragTip && ref) {\n      this.initDragging();\n    } else if (this.dragTip && !ref) {\n      this.destroyDragging();\n    }\n\n    this.dragTip = ref;\n  }\n\n  initDragging() {\n    const ns = this.props.classPrefix;\n    const submitOnChange = this.props.submitOnChange;\n    const dom = findDOMNode(this) as HTMLElement;\n    this.sortable = new Sortable(\n      dom.querySelector(`.${ns}Combo-items`) as HTMLElement,\n      {\n        group: `combo-${this.id}`,\n        animation: 150,\n        handle: `.${ns}Combo-itemDrager`,\n        ghostClass: `${ns}Combo-item--dragging`,\n        onEnd: (e: any) => {\n          // 没有移动\n          if (e.newIndex === e.oldIndex) {\n            return;\n          }\n\n          // 换回来\n          const parent = e.to as HTMLElement;\n          if (e.oldIndex < parent.childNodes.length - 1) {\n            parent.insertBefore(e.item, parent.childNodes[e.oldIndex]);\n          } else {\n            parent.appendChild(e.item);\n          }\n\n          const value = this.props.value;\n          if (!Array.isArray(value)) {\n            return;\n          }\n          const newValue = value.concat();\n          newValue.splice(e.newIndex, 0, newValue.splice(e.oldIndex, 1)[0]);\n          this.keys.splice(e.newIndex, 0, this.keys.splice(e.oldIndex, 1)[0]);\n          this.props.onChange(newValue, submitOnChange, true);\n        }\n      }\n    );\n  }\n\n  destroyDragging() {\n    this.sortable && this.sortable.destroy();\n  }\n\n  refsMap: {\n    [propName: number]: any;\n  } = {};\n\n  makeFormRef = memoize((index: number) => (ref: any) =>\n    this.formRef(ref, index)\n  );\n\n  formRef(ref: any, index: number = 0) {\n    if (ref) {\n      while (ref && ref.getWrappedInstance) {\n        ref = ref.getWrappedInstance();\n      }\n      this.subForms[index] = ref;\n      this.refsMap[index] = ref;\n    } else {\n      const form = this.refsMap[index];\n      this.subForms = this.subForms.filter(item => item !== form);\n      this.subFormDefaultValues = this.subFormDefaultValues.filter(\n        ({index: dIndex}) => dIndex !== index\n      );\n      delete this.refsMap[index];\n    }\n  }\n\n  memoizedFormatValue = memoize(\n    (strictMode: boolean, syncFields: Array<string> | void, value: any, index: number, data: any) => {\n      return createObject(\n        extendObject(data, {index, __index: index, ...data}),\n        {\n          ...value,\n          ...Array.isArray(syncFields) ? pickVars(data, syncFields!) : null\n        }\n      );\n    },\n    (strictMode: boolean, syncFields: Array<string> | void, value: any, index: number, data: any) =>\n    Array.isArray(syncFields) ? JSON.stringify([value, index, data, pickVars(data, syncFields)]): strictMode ? JSON.stringify([value, index]) : JSON.stringify([value, index, data])\n  );\n\n  formatValue(value: any, index: number) {\n    const {flat, data, strictMode, syncFields} = this.props;\n\n    if (flat) {\n      value = {\n        flat: value\n      };\n    }\n\n    value = value || this.defaultValue;\n\n    return this.memoizedFormatValue(strictMode !== false, syncFields, value, index, data);\n  }\n\n  pickCondition(value: any): Condition | null {\n    const conditions: Array<Condition> = this.props.conditions!;\n    return find(\n      conditions,\n      item => item.test && evalExpression(item.test, value)\n    ) as Condition | null;\n  }\n\n  handleComboTypeChange(index: number, selection: any) {\n    const {multiple, onChange, value, flat, submitOnChange} = this.props;\n\n    const conditions: Array<Condition> = this.props.conditions as Array<\n      Condition\n    >;\n    const condition = find(conditions, item => item.label === selection.label);\n\n    if (!condition) {\n      return;\n    }\n\n    if (multiple) {\n      const newValue = this.getValueAsArray();\n      newValue.splice(index, 1, {\n        ...dataMapping(condition.scaffold || {}, newValue[index])\n      });\n\n      // todo 支持 flat\n      onChange(newValue, submitOnChange, true);\n    } else {\n      onChange(\n        {\n          ...dataMapping(condition.scaffold || {}, value)\n        },\n        submitOnChange,\n        true\n      );\n    }\n  }\n\n  @autobind\n  handleTabSelect(key: number) {\n    const {store} = this.props;\n\n    store.setActiveKey(key);\n  }\n\n  renderPlaceholder() {\n    return (\n      <span className=\"text-muted\">{this.props.placeholder || '没有数据'}</span>\n    );\n  }\n\n  renderTabsMode() {\n    const {\n      classPrefix: ns,\n      classnames: cx,\n      tabsStyle,\n      formClassName,\n      render,\n      disabled,\n      store,\n      flat,\n      subFormMode,\n      addButtonText,\n      addable,\n      removable,\n      typeSwitchable,\n      itemRemovableOn,\n      delimiter,\n      canAccessSuperData,\n      addIcon,\n      deleteIcon,\n      tabsLabelTpl,\n      conditions,\n      changeImmediately\n    } = this.props;\n\n    let controls = this.props.controls;\n    let value = this.props.value;\n\n    if (flat && typeof value === 'string') {\n      value = value.split(delimiter || ',');\n    }\n\n    const finnalRemovable =\n      store.removable !== false && // minLength ?\n      !disabled && // 控件自身是否禁用\n      removable !== false; // 是否可以删除\n\n    if (!Array.isArray(value)) {\n      return this.renderPlaceholder();\n    }\n\n    // todo 支持拖拽排序。\n\n    return (\n      <CTabs\n        mode={tabsStyle}\n        activeKey={store.activeKey}\n        onSelect={this.handleTabSelect}\n        additionBtns={\n          !disabled ? (\n            <li className={cx(`Tabs-link`)}>\n              {store.addable && addable !== false ? (\n                Array.isArray(conditions) && conditions.length ? (\n                  render(\n                    'add-button',\n                    {\n                      type: 'dropdown-button',\n                      icon: addIcon,\n                      label: addButtonText || '新增',\n                      level: 'info',\n                      size: 'sm',\n                      closeOnClick: true\n                    },\n                    {\n                      buttons: conditions.map(item => ({\n                        label: item.label,\n                        onClick: (e: any) => {\n                          this.addItemWith(item);\n                          return false;\n                        }\n                      }))\n                    }\n                  )\n                ) : (\n                  <a onClick={this.addItem} data-tooltip=\"新增一条数据\">\n                    {addIcon ? <i className={cx('m-r-xs', addIcon)} /> : null}\n                    <span>{addButtonText || '新增'}</span>\n                  </a>\n                )\n              ) : null}\n            </li>\n          ) : null\n        }\n      >\n        {value.map((value, index) => {\n          const data = this.formatValue(value, index);\n          let condition: Condition | null | undefined = null;\n          let toolbar = undefined;\n          if (\n            finnalRemovable && // 表达式判断单条是否可删除\n            (!itemRemovableOn ||\n              evalExpression(itemRemovableOn, value) !== false)\n          ) {\n            toolbar = (\n              <a\n                onClick={this.removeItem.bind(this, index)}\n                key=\"remove\"\n                className={cx(\n                  `Combo-toolbarBtn ${!store.removable ? 'is-disabled' : ''}`\n                )}\n                data-tooltip=\"删除\"\n                data-position=\"bottom\"\n              >\n                <i className={deleteIcon} />\n              </a>\n            );\n          }\n\n          if (Array.isArray(conditions) && conditions.length) {\n            condition = this.pickCondition(data);\n            controls = condition ? condition.controls : undefined;\n          }\n\n          let finnalControls =\n            flat && controls\n              ? [\n                  {\n                    ...(controls && controls[0]),\n                    name: 'flat'\n                  }\n                ]\n              : controls;\n\n          return (\n            <Tab\n              title={filter(tabsLabelTpl || '成员${index|plus}', data)}\n              key={this.keys[index] || (this.keys[index] = guid())}\n              toolbar={toolbar}\n              eventKey={index}\n              // 不能按需渲染，因为 unique 会失效。\n              mountOnEnter={false}\n              unmountOnExit={false}\n            >\n              {condition && typeSwitchable !== false ? (\n                <div className={cx('Combo-itemTag')}>\n                  <label>类型</label>\n                  <Select\n                    onChange={this.handleComboTypeChange.bind(this, index)}\n                    options={(conditions as Array<Condition>).map(item => ({\n                      label: item.label,\n                      value: item.label\n                    }))}\n                    value={condition.label}\n                    clearable={false}\n                  />\n                </div>\n              ) : null}\n              <div className={cx(`Combo-itemInner`)}>\n                {finnalControls ? (\n                  render(\n                    `multiple/${index}`,\n                    {\n                      type: 'form',\n                      controls: finnalControls,\n                      wrapperComponent: 'div',\n                      wrapWithPanel: false,\n                      mode: subFormMode,\n                      className: cx(`Combo-form`, formClassName)\n                    },\n                    {\n                      index,\n                      disabled,\n                      data,\n                      onChange: this.handleChange,\n                      onInit: this.handleFormInit,\n                      onAction: this.handleAction,\n                      ref: this.makeFormRef(index),\n                      canAccessSuperData,\n                      lazyChange: changeImmediately ? false : true,\n                      lazyFormChange: changeImmediately ? false : true,\n                      value: undefined,\n                      formItemValue: undefined\n                    }\n                  )\n                ) : (\n                  <Alert2 level=\"warning\" className=\"m-b-none\">\n                    数据非法，或者数据已失效，请移除\n                  </Alert2>\n                )}\n              </div>\n            </Tab>\n          );\n        })}\n      </CTabs>\n    );\n  }\n\n  renderMultipe() {\n    if (this.props.tabsMode) {\n      return this.renderTabsMode();\n    }\n\n    const {\n      classPrefix: ns,\n      classnames: cx,\n      formClassName,\n      render,\n      multiLine,\n      addButtonClassName,\n      disabled,\n      store,\n      flat,\n      subFormMode,\n      draggable,\n      draggableTip,\n      addButtonText,\n      addable,\n      removable,\n      typeSwitchable,\n      itemRemovableOn,\n      delimiter,\n      canAccessSuperData,\n      addIcon,\n      dragIcon,\n      deleteIcon,\n      noBorder,\n      conditions,\n      lazyLoad,\n      changeImmediately\n    } = this.props;\n\n    let controls = this.props.controls;\n    let value = this.props.value;\n\n    if (flat && typeof value === 'string') {\n      value = value.split(delimiter || ',');\n    }\n\n    const finnalRemovable =\n      store.removable !== false && // minLength ?\n      !disabled && // 控件自身是否禁用\n      removable !== false; // 是否可以删除\n\n    return (\n      <div\n        className={cx(\n          `Combo Combo--multi`,\n          multiLine ? `Combo--ver` : `Combo--hor`,\n          noBorder ? `Combo--noBorder` : '',\n          disabled ? 'is-disabled' : ''\n        )}\n      >\n        <div className={cx(`Combo-items`)}>\n          {Array.isArray(value)\n            ? value.map((value, index, thelist) => {\n                const toolbar: Array<any> = [];\n\n                if (!disabled && draggable && thelist.length > 1) {\n                  toolbar.push(\n                    <a\n                      key=\"drag\"\n                      className={cx(`Combo-toolbarBtn Combo-itemDrager`)}\n                      data-tooltip=\"拖拽排序\"\n                      data-position=\"bottom\"\n                    >\n                      <i className={dragIcon} />\n                    </a>\n                  );\n                }\n\n                if (\n                  finnalRemovable && // 表达式判断单条是否可删除\n                  (!itemRemovableOn ||\n                    evalExpression(itemRemovableOn, value) !== false)\n                ) {\n                  toolbar.push(\n                    <a\n                      onClick={this.removeItem.bind(this, index)}\n                      key=\"remove\"\n                      className={cx(\n                        `Combo-toolbarBtn ${\n                          !store.removable ? 'is-disabled' : ''\n                        }`\n                      )}\n                      data-tooltip=\"删除\"\n                      data-position=\"bottom\"\n                    >\n                      <i className={deleteIcon} />\n                    </a>\n                  );\n                }\n\n                const data = this.formatValue(value, index);\n                let condition: Condition | null = null;\n\n                if (Array.isArray(conditions) && conditions.length) {\n                  condition = this.pickCondition(data);\n                  controls = condition ? condition.controls : undefined;\n                }\n\n                let finnalControls =\n                  flat && controls\n                    ? [\n                        {\n                          ...(controls && controls[0]),\n                          name: 'flat'\n                        }\n                      ]\n                    : controls;\n\n                return (\n                  <div\n                    className={cx(`Combo-item`)}\n                    key={this.keys[index] || (this.keys[index] = guid())}\n                  >\n                    {condition && typeSwitchable !== false ? (\n                      <div className={cx('Combo-itemTag')}>\n                        <label>类型</label>\n                        <Select\n                          onChange={this.handleComboTypeChange.bind(\n                            this,\n                            index\n                          )}\n                          options={(conditions as Array<Condition>).map(\n                            item => ({\n                              label: item.label,\n                              value: item.label\n                            })\n                          )}\n                          value={condition.label}\n                          clearable={false}\n                        />\n                      </div>\n                    ) : null}\n                    <div className={cx(`Combo-itemInner`)}>\n                      {finnalControls ? (\n                        render(\n                          `multiple/${index}`,\n                          {\n                            type: 'form',\n                            controls: finnalControls,\n                            wrapperComponent: 'div',\n                            wrapWithPanel: false,\n                            mode: multiLine ? subFormMode : 'row',\n                            className: cx(`Combo-form`, formClassName)\n                          },\n                          {\n                            index,\n                            disabled,\n                            data,\n                            onChange: this.handleChange,\n                            onInit: this.handleFormInit,\n                            onAction: this.handleAction,\n                            ref: this.makeFormRef(index),\n                            lazyChange: changeImmediately ? false : true,\n                            lazyFormChange: changeImmediately ? false : true,\n                            lazyLoad,\n                            canAccessSuperData,\n                            value: undefined,\n                            formItemValue: undefined\n                          }\n                        )\n                      ) : (\n                        <Alert2 level=\"warning\" className=\"m-b-none\">\n                          数据非法，或者数据已失效，请移除\n                        </Alert2>\n                      )}\n                    </div>\n                    {toolbar.length ? (\n                      <div className={cx(`Combo-itemToolbar`)}>{toolbar}</div>\n                    ) : null}\n                  </div>\n                );\n              })\n            : null}\n        </div>\n        {!disabled ? (\n          <div className={cx(`Combo-toolbar`)}>\n            {store.addable && addable !== false ? (\n              Array.isArray(conditions) && conditions.length ? (\n                render(\n                  'add-button',\n                  {\n                    type: 'dropdown-button',\n                    icon: addIcon,\n                    label: addButtonText || '新增',\n                    level: 'info',\n                    size: 'sm',\n                    closeOnClick: true\n                  },\n                  {\n                    buttons: conditions.map(item => ({\n                      label: item.label,\n                      onClick: (e: any) => {\n                        this.addItemWith(item);\n                        return false;\n                      }\n                    }))\n                  }\n                )\n              ) : (\n                <button\n                  type=\"button\"\n                  onClick={this.addItem}\n                  className={cx(`Button Combo-addBtn`, addButtonClassName)}\n                  data-tooltip=\"新增一条数据\"\n                >\n                  {addIcon ? (\n                    <i className={cx('Button-icon', addIcon)} />\n                  ) : null}\n                  <span>{addButtonText || '新增'}</span>\n                </button>\n              )\n            ) : null}\n            {draggable ? (\n              <span className={cx(`Combo-dragableTip`)} ref={this.dragTipRef}>\n                {Array.isArray(value) && value.length > 1 ? draggableTip : ''}\n              </span>\n            ) : null}\n          </div>\n        ) : null}\n      </div>\n    );\n  }\n\n  renderSingle() {\n    const {\n      conditions,\n      classnames: cx,\n      render,\n      value,\n      multiLine,\n      formClassName,\n      canAccessSuperData,\n      noBorder,\n      disabled,\n      typeSwitchable,\n    } = this.props;\n\n    let controls = this.props.controls;\n    const data = isObject(value) ? value : this.defaultValue;\n    let condition: Condition | null = null;\n\n    if (Array.isArray(conditions) && conditions.length) {\n      condition = this.pickCondition(data);\n      controls = condition ? condition.controls : undefined;\n    }\n\n    return (\n      <div\n        className={cx(\n          `Combo Combo--single`,\n          multiLine ? `Combo--ver` : `Combo--hor`,\n          noBorder ? `Combo--noBorder` : '',\n          disabled ? 'is-disabled' : ''\n        )}\n      >\n        <div className={cx(`Combo-item`)}>\n          {condition && typeSwitchable !== false ? (\n            <div className={cx('Combo-itemTag')}>\n              <label>类型</label>\n              <Select\n                onChange={this.handleComboTypeChange.bind(this, 0)}\n                options={(conditions as Array<Condition>).map(item => ({\n                  label: item.label,\n                  value: item.label\n                }))}\n                value={condition.label}\n                clearable={false}\n              />\n            </div>\n          ) : null}\n\n          <div className={cx(`Combo-itemInner`)}>\n            {controls ? (\n              render(\n                'single',\n                {\n                  type: 'form',\n                  controls,\n                  wrapperComponent: 'div',\n                  wrapWithPanel: false,\n                  mode: multiLine ? 'normal' : 'row',\n                  className: cx(`Combo-form`, formClassName)\n                },\n                {\n                  disabled: disabled,\n                  data: isObject(value) ? value : this.defaultValue,\n                  onChange: this.handleSingleFormChange,\n                  ref: this.makeFormRef(0),\n                  onInit: this.handleSingleFormInit,\n                  canAccessSuperData\n                }\n              )\n            ) : (\n              <Alert2 level=\"warning\" className=\"m-b-none\">\n                数据非法，或者数据已失效，请移除\n              </Alert2>\n            )}\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  render() {\n    const {formInited, multiple, className, classPrefix: ns, classnames: cx, disabled} = this.props;\n\n    return formInited ? (\n      <div className={cx(`ComboControl`, className)}>\n        {multiple ? this.renderMultipe() : this.renderSingle()}\n      </div>\n    ) : null;\n  }\n}\n\n@FormItem({\n  type: 'combo',\n  storeType: ComboStore.name,\n  extendsData: false\n})\nexport class ComboControlRenderer extends ComboControl {}\n"]}